<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>881b56046e1e40028ba3467bf09ee322</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown">
<html>
<div>
  <img src="https://www.engineersgarage.com/wp-content/uploads/2021/11/TCH36-01-scaled.jpg" width=360px width=auto style="vertical-align: middle;">
  <span style="font-family: Georgia; font-size:30px; color: white;"> <br/> University of Tehran <br/> AI_CA0 <br/> Spring 02 </span>
</div>
<span style="font-family: Georgia; font-size:15pt; color: white; vertical-align: middle;"> low_mist - std id: 810100186 </span>
</html>
<p>in this notebook we are to learn about data manipulation and predict
salary of the test file</p>
</div>
<div class="cell code" data-execution_count="1" id="p4gl7xPdimK1">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.axes <span class="im">as</span> pltaxes</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>TRAIN_FILE_ADDRESS <span class="op">=</span> <span class="st">&quot;assets/train.csv&quot;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>TEST_FILE_ADDRESS <span class="op">=</span> <span class="st">&quot;assets/test.csv&quot;</span></span></code></pre></div>
</div>
<div class="cell markdown" id="nqH_42oknWuR">
<p>1- <br/> the given csv has information about almost 30 thousand
people information such as: <html> <ol> <li> age </li> <li> workclass
</li> <li> fnlwgt</li> <li> education-num </li> <li> marital-status
</li> <li> occupation </li> <li> relationship </li> <li> race </li> <li>
sex </li> <li> capital-gain </li> <li> capital-loss </li> <li>
hours-per-week </li> <li> native-country </li>
<li style = "font-size:20pt; color: red;"> salary </li> </ol> </html>
first we learn about each of them<br/> then we manipulate the
information to draw and compare them<br/> then we will predict salary
based on one of them<br/></p>
</div>
<div class="cell code" data-execution_count="2" id="ENqvKt22nckU">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> pd.read_csv(TRAIN_FILE_ADDRESS)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>train_df_backup <span class="op">=</span> pd.read_csv(TRAIN_FILE_ADDRESS)</span></code></pre></div>
</div>
<div class="cell markdown" id="JRL30-F-n-oM">
<p><code>info</code>:<br/> this method gives information about the
database like column names and number of non-null values in each column
<br/> or type of the column <br/></p>
</div>
<div class="cell code" data-execution_count="3"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="-_pLe66rn1ch" data-outputId="ec2cb382-4fbf-448d-f19e-7f4204df3fc5">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_df.info())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 29825 entries, 0 to 29824
Data columns (total 15 columns):
 #   Column          Non-Null Count  Dtype 
---  ------          --------------  ----- 
 0   age             29825 non-null  int64 
 1   workclass       28154 non-null  object
 2   fnlwgt          29825 non-null  int64 
 3   education       29825 non-null  object
 4   education-num   29825 non-null  int64 
 5   marital-status  29825 non-null  object
 6   occupation      28149 non-null  object
 7   relationship    29825 non-null  object
 8   race            29825 non-null  object
 9   sex             29825 non-null  object
 10  capital-gain    29825 non-null  int64 
 11  capital-loss    29825 non-null  int64 
 12  hours-per-week  29825 non-null  int64 
 13  native-country  29288 non-null  object
 14  salary          29825 non-null  object
dtypes: int64(6), object(9)
memory usage: 3.4+ MB
None
</code></pre>
</div>
</div>
<div class="cell markdown" id="dO_j0N8sob3N">
<p><code>head and tail</code>:<br/> these methods respectively show us
the first and last 5 rows<br/> they are generally used to peek at the
data</p>
</div>
<div class="cell code" data-execution_count="4"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="aHAmvGJ6nv0_" data-outputId="0c25d13a-e029-4a9b-a0b1-88e99526a750">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>train_df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39</td>
      <td>State-gov</td>
      <td>77516</td>
      <td>Bachelors</td>
      <td>13</td>
      <td>Never-married</td>
      <td>Adm-clerical</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Male</td>
      <td>2174</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>Self-emp-not-inc</td>
      <td>83311</td>
      <td>Bachelors</td>
      <td>13</td>
      <td>Married-civ-spouse</td>
      <td>Exec-managerial</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>Private</td>
      <td>215646</td>
      <td>HS-grad</td>
      <td>9</td>
      <td>Divorced</td>
      <td>Handlers-cleaners</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>3</th>
      <td>53</td>
      <td>Private</td>
      <td>234721</td>
      <td>11th</td>
      <td>7</td>
      <td>Married-civ-spouse</td>
      <td>Handlers-cleaners</td>
      <td>Husband</td>
      <td>Black</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>4</th>
      <td>28</td>
      <td>Private</td>
      <td>338409</td>
      <td>Bachelors</td>
      <td>13</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Wife</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>Cuba</td>
      <td>&lt;=50K</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="5"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="VcnWRGSIoZOy" data-outputId="a8ba3484-177e-4af2-80d5-f10a5b637118">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>train_df.tail()</span></code></pre></div>
<div class="output execute_result" data-execution_count="5">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>29820</th>
      <td>48</td>
      <td>Local-gov</td>
      <td>127921</td>
      <td>Bachelors</td>
      <td>13</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>29821</th>
      <td>32</td>
      <td>Private</td>
      <td>42617</td>
      <td>Some-college</td>
      <td>10</td>
      <td>Divorced</td>
      <td>Prof-specialty</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>30</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>29822</th>
      <td>47</td>
      <td>Local-gov</td>
      <td>191389</td>
      <td>HS-grad</td>
      <td>9</td>
      <td>Divorced</td>
      <td>Adm-clerical</td>
      <td>Unmarried</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>35</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>29823</th>
      <td>38</td>
      <td>Private</td>
      <td>187983</td>
      <td>Prof-school</td>
      <td>15</td>
      <td>Married-civ-spouse</td>
      <td>Sales</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>29824</th>
      <td>18</td>
      <td>Private</td>
      <td>215110</td>
      <td>HS-grad</td>
      <td>9</td>
      <td>Never-married</td>
      <td>Handlers-cleaners</td>
      <td>Own-child</td>
      <td>Black</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown" id="GI3LDCyJomaK">
<p><code>describe</code>:<br/> this method gives general information
about each numerical column, namely: <ol> <li> count: number of not Nan
values</li> <li> mean: mean of each column</li> <li> std: standard
deviation of each column</li> <li> 25%, 50%, 75%: x% percentile of the
column</li> <li> max: maximum value of each column</li> </ol></p>
</div>
<div class="cell code" data-execution_count="6"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="lHM2OQTjol-n" data-outputId="1de52389-a60f-4959-cc3c-3352bfa1b471">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>train_df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fnlwgt</th>
      <th>education-num</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>29825.000000</td>
      <td>2.982500e+04</td>
      <td>29825.000000</td>
      <td>29825.000000</td>
      <td>29825.000000</td>
      <td>29825.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>38.581425</td>
      <td>1.897389e+05</td>
      <td>10.079229</td>
      <td>1094.586052</td>
      <td>86.476513</td>
      <td>40.434334</td>
    </tr>
    <tr>
      <th>std</th>
      <td>13.652005</td>
      <td>1.053738e+05</td>
      <td>2.571678</td>
      <td>7485.908646</td>
      <td>401.195078</td>
      <td>12.308174</td>
    </tr>
    <tr>
      <th>min</th>
      <td>17.000000</td>
      <td>1.228500e+04</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>28.000000</td>
      <td>1.178490e+05</td>
      <td>9.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>40.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>37.000000</td>
      <td>1.785170e+05</td>
      <td>10.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>40.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>48.000000</td>
      <td>2.368790e+05</td>
      <td>12.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>45.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>90.000000</td>
      <td>1.484705e+06</td>
      <td>16.000000</td>
      <td>99999.000000</td>
      <td>4356.000000</td>
      <td>99.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p>2 -<br/> first I use select_dtypes to choose the columns which should
be label encoded and then I use cat.codes <br/> note: i use dropna() so
it wont replace the not existing values with indexes</p>
</div>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> train_df.select_dtypes(<span class="st">&quot;object&quot;</span>).columns:</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    train_df[column] <span class="op">=</span> train_df[column].astype(<span class="st">&quot;category&quot;</span>).dropna().cat.codes</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>train_df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 29825 entries, 0 to 29824
Data columns (total 15 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   age             29825 non-null  int64  
 1   workclass       28154 non-null  float64
 2   fnlwgt          29825 non-null  int64  
 3   education       29825 non-null  int8   
 4   education-num   29825 non-null  int64  
 5   marital-status  29825 non-null  int8   
 6   occupation      28149 non-null  float64
 7   relationship    29825 non-null  int8   
 8   race            29825 non-null  int8   
 9   sex             29825 non-null  int8   
 10  capital-gain    29825 non-null  int64  
 11  capital-loss    29825 non-null  int64  
 12  hours-per-week  29825 non-null  int64  
 13  native-country  29288 non-null  float64
 14  salary          29825 non-null  int8   
dtypes: float64(3), int64(6), int8(6)
memory usage: 2.2 MB
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>now we can see for example that for sex column each Male is replaces
with 1 and Female is replaced with 0</p>
</div>
<div class="cell code" data-execution_count="8">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>train_df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39</td>
      <td>6.0</td>
      <td>77516</td>
      <td>9</td>
      <td>13</td>
      <td>4</td>
      <td>0.0</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>2174</td>
      <td>0</td>
      <td>40</td>
      <td>38.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>5.0</td>
      <td>83311</td>
      <td>9</td>
      <td>13</td>
      <td>2</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>38.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>3.0</td>
      <td>215646</td>
      <td>11</td>
      <td>9</td>
      <td>0</td>
      <td>5.0</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>38.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>53</td>
      <td>3.0</td>
      <td>234721</td>
      <td>1</td>
      <td>7</td>
      <td>2</td>
      <td>5.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>38.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>28</td>
      <td>3.0</td>
      <td>338409</td>
      <td>9</td>
      <td>13</td>
      <td>2</td>
      <td>9.0</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>4.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p>3 - <br/> now we should see percentage of NaN values in each
column</p>
</div>
<div class="cell code" data-execution_count="9">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>train_df.isnull().<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span> <span class="op">/</span> <span class="bu">len</span>(train_df)</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<pre><code>age               0.000000
workclass         5.602682
fnlwgt            0.000000
education         0.000000
education-num     0.000000
marital-status    0.000000
occupation        5.619447
relationship      0.000000
race              0.000000
sex               0.000000
capital-gain      0.000000
capital-loss      0.000000
hours-per-week    0.000000
native-country    1.800503
salary            0.000000
dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown">
<p>due to high percentage of Nan in workclass and occupation column I
will delete these two and replace NaN values in native-country with the
median</p>
</div>
<div class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> train_df.drop(<span class="st">&quot;workclass&quot;</span>, axis <span class="op">=</span> <span class="dv">1</span>).drop(<span class="st">&quot;occupation&quot;</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;native-country&quot;</span>].fillna(df[<span class="st">&quot;native-country&quot;</span>].mode()[<span class="dv">0</span>], inplace <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>now we can see that there is no Nan</p>
</div>
<div class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span> <span class="op">/</span> <span class="bu">len</span>(df)</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">
<pre><code>age               0.0
fnlwgt            0.0
education         0.0
education-num     0.0
marital-status    0.0
relationship      0.0
race              0.0
sex               0.0
capital-gain      0.0
capital-loss      0.0
hours-per-week    0.0
native-country    0.0
salary            0.0
dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown">
<p>an alternative way to handle Nan values can be to replace values with
mean which has it's own advantages and disadvantages: <dl>
<dt style="color: green;">advantages</dt> <dd>- it's convenient and
easy</dd> <dd>- it doesn't deviate datasets</dd>
<dt style="color: red;">disadvantages</dt> <dd>- causes the std to be
underestimated, may also obscure important features of the population
from which the data were sampled</dd> <dd>- the new data doesn't make
sense, for instance we have discrete values in our data but mean is not
valid</dd> <dd>- it may corrupt the correlation between features</dd>
</dl></p>
<p><a
href="https://www.analyticsvidhya.com/blog/2021/10/handling-missing-value/">click
here</a> for more information</p>
</div>
<div class="cell markdown">
<p>4 - <br/> first we have to find columns which have too many unique
values so it wont help our prediction<br/> in this project I consider
the number of unique values to be at least half to be considered as
column with unique values<br/></p>
</div>
<div class="cell code" data-execution_count="14">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df.columns[df.nunique() <span class="op">&gt;=</span> <span class="bu">len</span>(df) <span class="op">/</span> <span class="dv">2</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">
<pre><code>Index([&#39;fnlwgt&#39;], dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div class="cell markdown">
<p>so we have to drop fnlwgt column</p>
</div>
<div class="cell code" data-execution_count="15">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(<span class="st">&quot;fnlwgt&quot;</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 29825 entries, 0 to 29824
Data columns (total 12 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   age             29825 non-null  int64  
 1   education       29825 non-null  int8   
 2   education-num   29825 non-null  int64  
 3   marital-status  29825 non-null  int8   
 4   relationship    29825 non-null  int8   
 5   race            29825 non-null  int8   
 6   sex             29825 non-null  int8   
 7   capital-gain    29825 non-null  int64  
 8   capital-loss    29825 non-null  int64  
 9   hours-per-week  29825 non-null  int64  
 10  native-country  29825 non-null  float64
 11  salary          29825 non-null  int8   
dtypes: float64(1), int64(5), int8(6)
memory usage: 1.5 MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="17">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df.nunique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">
<pre><code>age                72
education          16
education-num      16
marital-status      7
relationship        6
race                5
sex                 2
capital-gain      118
capital-loss       91
hours-per-week     94
native-country     41
salary              2
dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown">
<p>5 - <br/> number of women</p>
</div>
<div class="cell code" data-execution_count="18">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(train_df_backup.loc[train_df_backup[<span class="st">&quot;sex&quot;</span>] <span class="op">==</span> <span class="st">&quot;Female&quot;</span>])</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">
<pre><code>9869</code></pre>
</div>
</div>
<div class="cell markdown">
<p>number of men</p>
</div>
<div class="cell code" data-execution_count="19">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(train_df_backup.loc[train_df_backup[<span class="st">&quot;sex&quot;</span>] <span class="op">==</span> <span class="st">&quot;Male&quot;</span>])</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">
<pre><code>19956</code></pre>
</div>
</div>
<div class="cell markdown">
<p>number of married men</p>
</div>
<div class="cell code" data-execution_count="20">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>married_options <span class="op">=</span> [<span class="st">&quot;Married-AF-spouse&quot;</span>, <span class="st">&quot;Married-civ-spouse&quot;</span>, <span class="st">&quot;Married-spouse-absent&quot;</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>married <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: x <span class="kw">in</span> married_options, train_df_backup[<span class="st">&quot;marital-status&quot;</span>]))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>men <span class="op">=</span> (train_df_backup[<span class="st">&quot;sex&quot;</span>] <span class="op">==</span> <span class="st">&quot;Male&quot;</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(train_df_backup.loc[married <span class="op">&amp;</span> men])</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">
<pre><code>12373</code></pre>
</div>
</div>
<div class="cell markdown">
<p>6 - <br/> number of black people above 30 who works privately</p>
</div>
<div class="cell code" data-execution_count="21">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>age <span class="op">=</span> (train_df_backup[<span class="st">&quot;age&quot;</span>] <span class="op">&gt;</span> <span class="dv">30</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>workclass <span class="op">=</span> (train_df_backup[<span class="st">&quot;workclass&quot;</span>] <span class="op">==</span> <span class="st">&quot;Private&quot;</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>race <span class="op">=</span> (train_df_backup[<span class="st">&quot;race&quot;</span>] <span class="op">==</span> <span class="st">&quot;Black&quot;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(train_df_backup.loc[race <span class="op">&amp;</span> age <span class="op">&amp;</span> workclass])</span></code></pre></div>
<div class="output execute_result" data-execution_count="21">
<pre><code>1274</code></pre>
</div>
</div>
<div class="cell markdown">
<p>7 - <br/> mean hours per weak for people who have bachelor
degrees</p>
</div>
<div class="cell code" data-execution_count="22">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mean_vectorized():</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> train_df_backup.loc[train_df_backup[<span class="st">&quot;education&quot;</span>] <span class="op">==</span> <span class="st">&quot;Bachelors&quot;</span>][<span class="st">&quot;hours-per-week&quot;</span>].mean()</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_vectorized())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>42.546669366268475
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>8 - <br/> now we are gonna do part 7 once again now without
vectorization</p>
</div>
<div class="cell code" data-execution_count="23">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mean_not_vectorized():</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">sum</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, person <span class="kw">in</span> train_df_backup.iterrows():</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> person[<span class="st">&quot;education&quot;</span>] <span class="op">==</span> <span class="st">&quot;Bachelors&quot;</span>:</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>            <span class="bu">sum</span> <span class="op">+=</span> person[<span class="st">&quot;hours-per-week&quot;</span>]</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>            count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span> <span class="op">/</span> count</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_not_vectorized())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>42.546669366268475
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>and now compare the running time of both ways</p>
</div>
<div class="cell code" data-execution_count="24">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> timeit</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_exec_time(setup, code):</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(timeit.repeat(setup <span class="op">=</span> setup, stmt <span class="op">=</span> code, number <span class="op">=</span> <span class="dv">100</span>, repeat <span class="op">=</span> <span class="dv">2</span>)) <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;vectorized: &quot;</span>, calc_exec_time(<span class="st">&#39;&#39;&#39;from __main__ import mean_vectorized&#39;&#39;&#39;</span>, <span class="st">&#39;&#39;&#39;mean_vectorized()&#39;&#39;&#39;</span>))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;not-vectorized: &quot;</span>, calc_exec_time(<span class="st">&#39;&#39;&#39;from __main__ import mean_not_vectorized&#39;&#39;&#39;</span>, <span class="st">&#39;&#39;&#39;mean_not_vectorized()&#39;&#39;&#39;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>vectorized:  0.0017192860000068322
not-vectorized:  0.5268616219999968
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>obviously as expected not-vectorization is slower</p>
</div>
<div class="cell markdown">
<p>9 - <br/> draw hist diagram of each distribution</p>
</div>
<div class="cell code" data-execution_count="25">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df.hist(figsize <span class="op">=</span> (<span class="dv">15</span>, <span class="dv">15</span>), legend <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="25">
<pre><code>array([[&lt;Axes: title={&#39;center&#39;: &#39;age&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;education&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;education-num&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;marital-status&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;relationship&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;race&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;sex&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;capital-gain&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;capital-loss&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;hours-per-week&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;native-country&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;salary&#39;}&gt;]], dtype=object)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_ec501b078db0485eae22d4d1965e675b/53f5c13fd7e82e25aff37ef3557200a603e06098.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>10 - <br/> in order to improve the model we normalize our datas <br/>
I will use standard score method, you can search and check for other
methods</p>
</div>
<div class="cell code" data-execution_count="26">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>normalized_df <span class="op">=</span> (df <span class="op">-</span> df.mean()) <span class="op">/</span> df.std()</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>normalized_df.hist(figsize <span class="op">=</span> (<span class="dv">15</span>, <span class="dv">15</span>), legend <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="26">
<pre><code>array([[&lt;Axes: title={&#39;center&#39;: &#39;age&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;education&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;education-num&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;marital-status&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;relationship&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;race&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;sex&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;capital-gain&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;capital-loss&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;hours-per-week&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;native-country&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;salary&#39;}&gt;]], dtype=object)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_ec501b078db0485eae22d4d1965e675b/73aa322bd7cd1c02b4ee9c1aac6bec252a69915e.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="27">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(normalized_df.describe().loc[[<span class="st">&quot;std&quot;</span>, <span class="st">&quot;mean&quot;</span>]])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>               age     education  education-num  marital-status  relationship  \
std   1.000000e+00  1.000000e+00   1.000000e+00    1.000000e+00  1.000000e+00   
mean -1.639073e-16  2.491962e-16  -1.243599e-16   -1.150686e-16  6.837410e-17   

              race           sex  capital-gain  capital-loss  hours-per-week  \
std   1.000000e+00  1.000000e+00  1.000000e+00  1.000000e+00    1.000000e+00   
mean  2.291843e-16 -4.550332e-17 -1.643837e-17 -4.740922e-17    2.699229e-16   

      native-country        salary  
std     1.000000e+00  1.000000e+00  
mean    3.680766e-16  8.886251e-17  
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>each column has std of 1 and almost mean of 0, so it has successfully
been normalized</p>
</div>
<div class="cell markdown">
<p>11 - <br/></p>
</div>
<div class="cell code" data-execution_count="28">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>higher_than_50_salary <span class="op">=</span> (train_df_backup[<span class="st">&quot;salary&quot;</span>] <span class="op">==</span> <span class="st">&quot;&gt;50K&quot;</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>high_salary <span class="op">=</span> normalized_df.loc[higher_than_50_salary]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>low_salary <span class="op">=</span> normalized_df.loc[<span class="op">~</span>higher_than_50_salary]</span></code></pre></div>
</div>
<div class="cell markdown">
<p>now we compute the mean and standard deviation of each column</p>
</div>
<div class="cell code" data-execution_count="29">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>high_salary_mean <span class="op">=</span> high_salary.mean()</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>high_salary_std <span class="op">=</span> high_salary.std()</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>low_salary_mean <span class="op">=</span> low_salary.mean()</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>low_salary_std <span class="op">=</span> low_salary.std()</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>stats <span class="op">=</span> pd.DataFrame({</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;high_salary_mean&quot;</span>: high_salary_mean, </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;high_salary_std&quot;</span>: high_salary_std,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;low_salary_mean&quot;</span>: low_salary_mean,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;low_salary_std&quot;</span>: low_salary_std</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stats[[<span class="st">&quot;high_salary_mean&quot;</span>, <span class="st">&quot;high_salary_std&quot;</span>]])</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;------------------------------------------------------&quot;</span>)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stats[[<span class="st">&quot;low_salary_mean&quot;</span>, <span class="st">&quot;low_salary_std&quot;</span>]])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                high_salary_mean  high_salary_std
age                     0.414559     7.712003e-01
education               0.134591     7.346369e-01
education-num           0.594376     9.315441e-01
marital-status         -0.353505     5.664315e-01
relationship           -0.445503     9.840132e-01
race                    0.130958     8.597122e-01
sex                     0.385660     7.577055e-01
capital-gain            0.399265     1.976087e+00
capital-loss            0.261746     1.473212e+00
hours-per-week          0.406811     8.874651e-01
native-country          0.040233     9.543237e-01
salary                  1.780138     2.220601e-16
------------------------------------------------------
                low_salary_mean  low_salary_std
age                   -0.130817    1.027893e+00
education             -0.042471    1.066660e+00
education-num         -0.187560    9.460967e-01
marital-status         0.111551    1.078173e+00
relationship           0.140582    9.631487e-01
race                  -0.041325    1.036940e+00
sex                   -0.121698    1.035700e+00
capital-gain          -0.125991    1.314654e-01
capital-loss          -0.082596    7.760948e-01
hours-per-week        -0.128372    9.991788e-01
native-country        -0.012696    1.013675e+00
salary                -0.561735    1.110248e-16
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>now we will assign a normal distribution with that mean and standard
deviation to each row, for high and low separately<br/> and store them
in a dictionary</p>
</div>
<div class="cell code" data-execution_count="30">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">0.01</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>distribution <span class="op">=</span> {}</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw(row : pd.Series, ax : pltaxes._axes.Axes):</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    high_salary_dist <span class="op">=</span> scipy.stats.norm(row[<span class="st">&quot;high_salary_mean&quot;</span>], row[<span class="st">&quot;high_salary_std&quot;</span>])</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    low_salary_dist <span class="op">=</span> scipy.stats.norm(row[<span class="st">&quot;low_salary_mean&quot;</span>], row[<span class="st">&quot;low_salary_std&quot;</span>])</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    distribution[row.name] <span class="op">=</span> (high_salary_dist, low_salary_dist)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    high_salary_pdf <span class="op">=</span> high_salary_dist.pdf(x_values)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    low_salary_pdf <span class="op">=</span> low_salary_dist.pdf(x_values)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    ax.plot(x_values, </span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>            high_salary_pdf,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>            label <span class="op">=</span> <span class="st">&quot;higher than 50k salary&quot;</span>,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>            color <span class="op">=</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>    ax.plot(x_values,</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>            low_salary_pdf,</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>            label <span class="op">=</span> <span class="st">&quot;lower than 50k salary&quot;</span>,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>            color <span class="op">=</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    ax.legend(loc <span class="op">=</span> <span class="st">&quot;upper left&quot;</span>, frameon <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    ax.set_title(row.name)</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">&quot;x&quot;</span>)</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">&quot;pdf&quot;</span>)</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>    </span></code></pre></div>
</div>
<div class="cell code" data-execution_count="32">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>numerics <span class="op">=</span> [<span class="st">&quot;age&quot;</span>, <span class="st">&quot;education-num&quot;</span>, <span class="st">&quot;capital-gain&quot;</span>, <span class="st">&quot;capital-loss&quot;</span>, <span class="st">&quot;hours-per-week&quot;</span>]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">20</span>, <span class="dv">15</span>), nrows <span class="op">=</span> <span class="bu">len</span>(numerics))</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(pad <span class="op">=</span> <span class="fl">4.0</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>ax_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> stats.iterrows():</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row.name <span class="kw">not</span> <span class="kw">in</span> numerics:</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    draw(row, axes[ax_index])</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    ax_index <span class="op">+=</span> <span class="dv">1</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_ec501b078db0485eae22d4d1965e675b/131eabf5b315b458757eed8adb51107131b7d099.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>we want to predict only based on one feature so we choose the one
which has the most effect on the salary, <br/> i.e. the <span
class="math inline"><em>f</em>(<em>s</em><em>a</em><em>l</em><em>a</em><em>r</em><em>y</em>|<em>f</em><em>e</em><em>a</em><em>t</em><em>u</em><em>r</em><em>e</em>)</span>
has the most difference in high and low salary for that given feature
<br/> according to the graphs that feature is capital-gain <br/>
<!-- but in order to have thorough investigation we will show use all above datas to predict each of them <br/>
will contribute to the final result with coefficient of $1/std$ and whichever has higher result will be our prediction --></p>
</div>
<div class="cell markdown">
<p>now for deciding based on capital-gain:<br/> we will compute <span
class="math inline"><em>f</em>(<em>h</em><em>i</em><em>g</em><em>h</em><em>s</em><em>a</em><em>l</em><em>a</em><em>r</em><em>y</em>|<em>f</em><em>e</em><em>a</em><em>t</em><em>u</em><em>r</em><em>e</em>)</span>
and $f(low_salary|feature) and compare them<br/> since we do not now how
to calculate them we use Bayesian predictions which gives us this: <span
class="math display">$$f(a|b) = \frac{f(b|a) \times
f(a)}{f(b)}$$</span></p>
</div>
<div class="cell markdown">
<p>I need columns dist to calculate probability</p>
</div>
<div class="cell code" data-execution_count="49">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>deciding_feature <span class="op">=</span> <span class="st">&quot;capital-gain&quot;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>deciding_feature_dist <span class="op">=</span> scipy.stats.norm(df[deciding_feature].mean(), df[deciding_feature].std())</span></code></pre></div>
</div>
<div class="cell markdown">
<p>and also high and low salary probabilities for f(a)</p>
</div>
<div class="cell code" data-execution_count="51">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>high_salary_probability <span class="op">=</span> <span class="bu">len</span>(high_salary) <span class="op">/</span> <span class="bu">len</span>(df)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>low_salary_probability <span class="op">=</span> <span class="bu">len</span>(low_salary) <span class="op">/</span> <span class="bu">len</span>(df)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>now let's calculate</p>
</div>
<div class="cell code" data-execution_count="52">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict_single_person(person : pd.Series):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    high_salary_dist, low_salary_dist <span class="op">=</span> distribution[deciding_feature]</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    feature_probability <span class="op">=</span> deciding_feature_dist.pdf(person[deciding_feature])</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    high_salary_prob <span class="op">=</span> high_salary_dist.pdf(person[deciding_feature]) <span class="op">*</span> high_salary_probability <span class="op">/</span> feature_probability</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    low_salary_prob <span class="op">=</span> low_salary_dist.pdf(person[deciding_feature]) <span class="op">*</span> low_salary_probability <span class="op">/</span> feature_probability</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">&quot;&gt;50K&quot;</span> <span class="cf">if</span> high_salary_prob <span class="op">&gt;</span> low_salary_prob <span class="cf">else</span> <span class="st">&quot;&lt;=50K&quot;</span></span></code></pre></div>
</div>
<div class="cell markdown">
<p>now we read and normalize the test file</p>
</div>
<div class="cell code" data-execution_count="53">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>test_df <span class="op">=</span> pd.read_csv(TEST_FILE_ADDRESS)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>data_needed_for_prediction <span class="op">=</span> test_df.drop([<span class="st">&quot;fnlwgt&quot;</span>], axis <span class="op">=</span> <span class="dv">1</span>) <span class="co"># it&#39;s the unique column</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>data_needed_for_prediction <span class="op">=</span> data_needed_for_prediction[numerics]</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[numerics]</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>data_needed_for_prediction <span class="op">=</span> (data_needed_for_prediction <span class="op">-</span> df.mean()) <span class="op">/</span> df.std()</span></code></pre></div>
</div>
<div class="cell markdown">
<p>now we predict each of them</p>
</div>
<div class="cell code" data-execution_count="55">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> []</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> data_needed_for_prediction.iterrows():</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    predictions.append(predict_single_person(row))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>right_answers <span class="op">=</span> <span class="bu">sum</span>(predictions <span class="op">==</span> test_df[<span class="st">&quot;salary&quot;</span>])</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;accuracy based on capital-gain: </span><span class="sc">{</span>right_answers <span class="op">/</span> <span class="bu">len</span>(test_df) <span class="op">*</span> <span class="dv">100</span><span class="sc">}</span><span class="ss">%&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>accuracy based on capital-gain: 78.50877192982456%
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>now we save results</p>
</div>
<div class="cell code" data-execution_count="56">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>RESULT_FILE_ADDRESS <span class="op">=</span> <span class="st">&quot;assets/result.csv&quot;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>result_df <span class="op">=</span> pd.DataFrame(predictions)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>result_df.to_csv(RESULT_FILE_ADDRESS, index <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
</div>
<section id="conclusion" class="cell markdown">
<h2>Conclusion</h2>
<p>with reading and storing data we were able to predict results of new
data <br/> in this project we only used one of the features so it was
not too much accurate but still we got a pretty good prediction</p>
</section>
<section id="references" class="cell markdown">
<h1>References</h1>
<ul>
<li><a
href="https://www.analyticsvidhya.com/blog/2021/10/handling-missing-value/">How
to handle Nan</a></li>
</ul>
</section>
</body>
</html>
